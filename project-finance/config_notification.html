<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>通知设置 - 系统设置</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>tailwind.config = { theme: { extend: { animation: { 'fade-in': 'fadeIn 0.3s ease-out' }, keyframes: { fadeIn: { '0%': { opacity: '0' }, '100%': { opacity: '1' } } } } } }</script>
    <style>
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        body { overflow-x: hidden; }
        .toggle-switch { position: relative; width: 44px; height: 24px; }
        .toggle-switch input { opacity: 0; width: 0; height: 0; }
        .toggle-slider { position: absolute; cursor: pointer; inset: 0; background-color: #cbd5e1; transition: .3s; border-radius: 24px; }
        .toggle-slider:before { position: absolute; content: ""; height: 18px; width: 18px; left: 3px; bottom: 3px; background-color: white; transition: .3s; border-radius: 50%; }
        input:checked + .toggle-slider { background-color: #6366f1; }
        input:checked + .toggle-slider:before { transform: translateX(20px); }
    </style>
</head>
<body class="bg-[#F8FAFC]">
    <div id="root"></div>
    <script type="text/babel">
        const { useState } = React;

        const IconWrapper = ({ children, size = 18, className = "", ...props }) => (<svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className} {...props}>{children}</svg>);
        const Bell = (p) => <IconWrapper {...p}><path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"/><path d="M10.3 21a1.94 1.94 0 0 0 3.4 0"/></IconWrapper>;
        const Mail = (p) => <IconWrapper {...p}><rect width="20" height="16" x="2" y="4" rx="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/></IconWrapper>;
        const MessageSquare = (p) => <IconWrapper {...p}><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></IconWrapper>;
        const AlertTriangle = (p) => <IconWrapper {...p}><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"/><path d="M12 9v4"/><path d="M12 17h.01"/></IconWrapper>;
        const Save = (p) => <IconWrapper {...p}><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></IconWrapper>;
        const TestTube = (p) => <IconWrapper {...p}><path d="M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5h0c-1.4 0-2.5-1.1-2.5-2.5V2"/><path d="M8.5 2h7"/><path d="M14.5 16h-5"/></IconWrapper>;

        const Toggle = ({ checked, onChange }) => (
            <label className="toggle-switch">
                <input type="checkbox" checked={checked} onChange={e => onChange(e.target.checked)} />
                <span className="toggle-slider"></span>
            </label>
        );

        const App = () => {
            const [settings, setSettings] = useState({
                // 预算预警
                budgetWarningEnabled: true,
                budgetThreshold80: true,
                budgetThreshold90: true,
                budgetThreshold100: true,
                // 数据异常预警
                dataAnomalyEnabled: true,
                returnRateWarning: true,
                profitDropWarning: true,
                // 邮件通知
                emailEnabled: true,
                emailRecipients: 'finance@company.com, manager@company.com',
                emailFrequency: 'realtime',
                // 企微通知
                wechatEnabled: true,
                wechatWebhook: 'https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=xxx-xxx-xxx',
                wechatMentionAll: false,
            });

            const updateSetting = (key, value) => {
                setSettings(prev => ({ ...prev, [key]: value }));
            };

            const handleSave = () => {
                alert('设置已保存！');
            };

            const handleTest = (type) => {
                alert(`${type === 'email' ? '邮件' : '企微'}测试通知已发送！`);
            };

            return (
                <div className="p-8 max-w-[1200px] mx-auto animate-fade-in">
                    <div className="mb-8 flex justify-between items-end">
                        <div>
                            <h2 className="text-2xl font-bold text-slate-800 flex items-center gap-3">
                                <div className="w-10 h-10 rounded-xl bg-orange-100 flex items-center justify-center">
                                    <Bell size={20} className="text-orange-600" />
                                </div>
                                通知设置
                            </h2>
                            <p className="text-slate-500 text-sm mt-1 ml-13">配置预算预警、数据异常告警及通知渠道</p>
                        </div>
                        <button onClick={handleSave} className="px-5 py-2.5 bg-indigo-600 text-white rounded-xl shadow-lg shadow-indigo-200 hover:bg-indigo-700 transition-all flex items-center gap-2 text-sm font-medium">
                            <Save size={18} /> 保存设置
                        </button>
                    </div>

                    <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        {/* 预算预警设置 */}
                        <div className="bg-white rounded-[2rem] shadow-sm border border-slate-100 overflow-hidden">
                            <div className="p-6 border-b border-slate-100 flex items-center gap-3">
                                <div className="w-10 h-10 rounded-xl bg-amber-100 flex items-center justify-center">
                                    <AlertTriangle size={20} className="text-amber-600" />
                                </div>
                                <div>
                                    <h3 className="font-bold text-slate-800">预算超支预警</h3>
                                    <p className="text-xs text-slate-400">当预算执行达到阈值时发送预警</p>
                                </div>
                                <div className="ml-auto">
                                    <Toggle checked={settings.budgetWarningEnabled} onChange={v => updateSetting('budgetWarningEnabled', v)} />
                                </div>
                            </div>
                            <div className={`p-6 space-y-4 ${!settings.budgetWarningEnabled && 'opacity-50 pointer-events-none'}`}>
                                <div className="flex items-center justify-between p-4 bg-slate-50 rounded-xl">
                                    <div>
                                        <div className="font-medium text-slate-700">预算执行率 ≥ 80%</div>
                                        <div className="text-xs text-slate-400">提前预警，提醒关注</div>
                                    </div>
                                    <Toggle checked={settings.budgetThreshold80} onChange={v => updateSetting('budgetThreshold80', v)} />
                                </div>
                                <div className="flex items-center justify-between p-4 bg-slate-50 rounded-xl">
                                    <div>
                                        <div className="font-medium text-slate-700">预算执行率 ≥ 90%</div>
                                        <div className="text-xs text-slate-400">警告级别，需要控制支出</div>
                                    </div>
                                    <Toggle checked={settings.budgetThreshold90} onChange={v => updateSetting('budgetThreshold90', v)} />
                                </div>
                                <div className="flex items-center justify-between p-4 bg-red-50 rounded-xl border border-red-100">
                                    <div>
                                        <div className="font-medium text-red-700">预算执行率 ≥ 100%</div>
                                        <div className="text-xs text-red-400">超支预警，立即处理</div>
                                    </div>
                                    <Toggle checked={settings.budgetThreshold100} onChange={v => updateSetting('budgetThreshold100', v)} />
                                </div>
                            </div>
                        </div>

                        {/* 数据异常预警 */}
                        <div className="bg-white rounded-[2rem] shadow-sm border border-slate-100 overflow-hidden">
                            <div className="p-6 border-b border-slate-100 flex items-center gap-3">
                                <div className="w-10 h-10 rounded-xl bg-red-100 flex items-center justify-center">
                                    <AlertTriangle size={20} className="text-red-600" />
                                </div>
                                <div>
                                    <h3 className="font-bold text-slate-800">数据异常预警</h3>
                                    <p className="text-xs text-slate-400">监控关键指标异常波动</p>
                                </div>
                                <div className="ml-auto">
                                    <Toggle checked={settings.dataAnomalyEnabled} onChange={v => updateSetting('dataAnomalyEnabled', v)} />
                                </div>
                            </div>
                            <div className={`p-6 space-y-4 ${!settings.dataAnomalyEnabled && 'opacity-50 pointer-events-none'}`}>
                                <div className="flex items-center justify-between p-4 bg-slate-50 rounded-xl">
                                    <div>
                                        <div className="font-medium text-slate-700">退货率异常</div>
                                        <div className="text-xs text-slate-400">退货率环比上升超过 20%</div>
                                    </div>
                                    <Toggle checked={settings.returnRateWarning} onChange={v => updateSetting('returnRateWarning', v)} />
                                </div>
                                <div className="flex items-center justify-between p-4 bg-slate-50 rounded-xl">
                                    <div>
                                        <div className="font-medium text-slate-700">利润下降预警</div>
                                        <div className="text-xs text-slate-400">利润率环比下降超过 15%</div>
                                    </div>
                                    <Toggle checked={settings.profitDropWarning} onChange={v => updateSetting('profitDropWarning', v)} />
                                </div>
                            </div>
                        </div>

                        {/* 邮件通知 */}
                        <div className="bg-white rounded-[2rem] shadow-sm border border-slate-100 overflow-hidden">
                            <div className="p-6 border-b border-slate-100 flex items-center gap-3">
                                <div className="w-10 h-10 rounded-xl bg-blue-100 flex items-center justify-center">
                                    <Mail size={20} className="text-blue-600" />
                                </div>
                                <div>
                                    <h3 className="font-bold text-slate-800">邮件通知</h3>
                                    <p className="text-xs text-slate-400">通过邮件发送预警通知</p>
                                </div>
                                <div className="ml-auto">
                                    <Toggle checked={settings.emailEnabled} onChange={v => updateSetting('emailEnabled', v)} />
                                </div>
                            </div>
                            <div className={`p-6 space-y-4 ${!settings.emailEnabled && 'opacity-50 pointer-events-none'}`}>
                                <div>
                                    <label className="block text-sm font-medium text-slate-600 mb-2">收件人邮箱</label>
                                    <textarea 
                                        value={settings.emailRecipients} 
                                        onChange={e => updateSetting('emailRecipients', e.target.value)}
                                        rows={2}
                                        placeholder="多个邮箱用逗号分隔"
                                        className="w-full px-4 py-3 border border-slate-200 rounded-xl text-sm focus:ring-2 focus:ring-indigo-100 focus:border-indigo-300 outline-none resize-none"
                                    />
                                </div>
                                <div>
                                    <label className="block text-sm font-medium text-slate-600 mb-2">发送频率</label>
                                    <select 
                                        value={settings.emailFrequency} 
                                        onChange={e => updateSetting('emailFrequency', e.target.value)}
                                        className="w-full px-4 py-3 border border-slate-200 rounded-xl text-sm focus:ring-2 focus:ring-indigo-100 outline-none bg-white"
                                    >
                                        <option value="realtime">实时发送</option>
                                        <option value="hourly">每小时汇总</option>
                                        <option value="daily">每日汇总</option>
                                    </select>
                                </div>
                                <button onClick={() => handleTest('email')} className="w-full py-2.5 border border-blue-200 text-blue-600 rounded-xl text-sm font-medium hover:bg-blue-50 flex items-center justify-center gap-2">
                                    <TestTube size={16} /> 发送测试邮件
                                </button>
                            </div>
                        </div>

                        {/* 企微通知 */}
                        <div className="bg-white rounded-[2rem] shadow-sm border border-slate-100 overflow-hidden">
                            <div className="p-6 border-b border-slate-100 flex items-center gap-3">
                                <div className="w-10 h-10 rounded-xl bg-green-100 flex items-center justify-center">
                                    <MessageSquare size={20} className="text-green-600" />
                                </div>
                                <div>
                                    <h3 className="font-bold text-slate-800">企业微信通知</h3>
                                    <p className="text-xs text-slate-400">通过企微机器人发送预警</p>
                                </div>
                                <div className="ml-auto">
                                    <Toggle checked={settings.wechatEnabled} onChange={v => updateSetting('wechatEnabled', v)} />
                                </div>
                            </div>
                            <div className={`p-6 space-y-4 ${!settings.wechatEnabled && 'opacity-50 pointer-events-none'}`}>
                                <div>
                                    <label className="block text-sm font-medium text-slate-600 mb-2">Webhook 地址</label>
                                    <input 
                                        type="text"
                                        value={settings.wechatWebhook} 
                                        onChange={e => updateSetting('wechatWebhook', e.target.value)}
                                        placeholder="企微机器人 Webhook URL"
                                        className="w-full px-4 py-3 border border-slate-200 rounded-xl text-sm focus:ring-2 focus:ring-indigo-100 focus:border-indigo-300 outline-none font-mono text-xs"
                                    />
                                </div>
                                <div className="flex items-center justify-between p-4 bg-slate-50 rounded-xl">
                                    <div>
                                        <div className="font-medium text-slate-700">@所有人</div>
                                        <div className="text-xs text-slate-400">紧急预警时 @所有人</div>
                                    </div>
                                    <Toggle checked={settings.wechatMentionAll} onChange={v => updateSetting('wechatMentionAll', v)} />
                                </div>
                                <button onClick={() => handleTest('wechat')} className="w-full py-2.5 border border-green-200 text-green-600 rounded-xl text-sm font-medium hover:bg-green-50 flex items-center justify-center gap-2">
                                    <TestTube size={16} /> 发送测试消息
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
